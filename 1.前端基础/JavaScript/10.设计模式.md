# 设计模式

## 1.目的

设计模式是为了更好的代码复用、可读、可靠、可维护。

## 2.原则

1、单一职责原则（SRP）[Single Responsibility Principle]

一个对象（方法）只做一件事情

2、里氏替换原则

子类可以扩展父类的功能，但不能改变父类原有的功能

3、依赖倒置原则

高层模块不应该依赖低层模块，二者都应该依赖其抽象。抽象不应该依赖细节，细节应该依赖抽象。(就是将公共的业务逻辑抽象出来)

4、接口隔离原则

在一个类中尽量少公布public方法，接口是对外的承诺，承诺越少对系统的开发越有利，变更的风险也就越少，同时也有利于降低成本

5、合成复用原则

尽量使用对象组合/聚合，而不是继承关系达到软件复用的目的

6、最少知识原则

减少对象（方法、系统、模块等）之间的联系

## 3.类型

- 创建型
  - 单例模式
  - 工厂模式
  - 抽象工厂模式
  - 原型模式
  - 建造者模式
- 结构型
  - 适配器模式
  - 装饰器模式
  - 代理模式
  - 外观模式
  - 桥接模式
  - 组合模式
  - 享元模式
- 行为型
  - 观察者模式
  - 迭代器模式
  - 策略模式
  - 模板方法模式
  - 职责链模式
  - 命令模式
  - 备忘录模式
  - 状态模式
  - 访问者模式
  - 中介者模式
  - 解释器模式

### 3.1 单例模式（Singleton）

专业解释：

单例模式是一种确保在任何情况下一个类仅有一个实例，并提供全局访问点的设计模式。它主要用于控制对全局唯一资源的访问。

通俗理解：

就好比一座城市里只有一座供水站，不论你需要从哪里取水，都只能通过这个供水站来获取，而且全市人民共用的是同一座供水站。

> 优点：

节约系统资源，对于那些需要频繁创建和销毁的对象，单例模式可以提高系统性能。

提供了全局访问点，对象间通信更简单。

> 缺点：

不适用于多线程环境，可能会引起线程安全问题。

单例对象的状态，对于依赖它的对象可能不易处理。

单例模式在系统中引入全局状态，增加了测试的复杂性。

### 3.2 工厂模式（Factory）

- 简单工厂模式
- 工厂方法模式
- 抽象工厂模式

#### 3.2.1 简单工厂模式

又叫静态工厂模式，由一个工厂对象决定创建某一种产品对象类的实例。主要用来创建同一类对象。

实际的项目中，我们常常需要根据用户的权限来渲染不同的页面，高级权限的用户所拥有的页面有些是无法被低级权限的用户所查看。

简单工厂的优点在于，你只需要一个正确的参数，就可以获取到你所需要的对象，而无需知道其创建的具体细节。但是在函数内包含了所有对象的创建逻辑（构造函数）和判断逻辑的代码，每增加新的构造函数还需要修改判断逻辑代码。当我们的对象不是上面的3个而是30个或更多时，这个函数会成为一个庞大的超级函数，便得难以维护。

> 注意: 简单工厂只能作用于创建的对象数量较少，对象的创建逻辑不复杂时使用

#### 3.2.2 工厂方法模式

工厂方法模式的本意是`将实际创建对象的工作推迟到子类`中，这样核心类就变成了抽象类。但是在JavaScript中很难像传统面向对象那样去实现创建抽象类。所以在JavaScript中我们只需要参考它的核心思想即可。我们可以将工厂方法看作是一个实例化对象的工厂类。

虽然ES6也没有实现abstract，但是我们可以使用 `new.target` 来模拟出抽象类。`new.target` 指向直接被new执行的构造函数，我们`对new.target进行判断，如果指向了该类则抛出错误来使得该类成为抽象类`。

在简单工厂模式中，我们每添加一个构造函数需要修改两处代码。现在我们使用工厂方法模式改造上面的代码，刚才提到，工厂方法我们只把它看作是一个实例化对象的工厂，它只做实例化对象这一件事情！

#### 3.2.3 抽象工厂模式（Abstract Factory）

抽象工厂模式并不直接生成实例， 而是用于对`产品类簇的创建`。

在抽象工厂中，类簇一般用父类定义，并在父类中定义一些抽象方法，再通过抽象工厂让子类继承父类。所以，`抽象工厂其实是实现子类继承父类的方法`。

抽象方法是指声明但不能使用的方法。在其他传统面向对象的语言中常用abstract进行声明，但是在JavaScript中，abstract是属于保留字，但是我们可以通过在类的方法中抛出错误来模拟抽象类。

专业解释：

抽象工厂模式提供一个接口用于创建一系列相关或相互依赖的对象，而无需指定具体类。客户端使用此接口选择所需的产品族中的产品对象。

通俗理解：

设想一个汽车工厂不仅能生产各种类型的车（如轿车、SUV等），还能生产配套的轮胎和内饰。客户只要告诉工厂要哪种类型的车，工厂就会相应地提供整套适合的汽车部件。
